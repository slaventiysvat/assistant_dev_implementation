#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –ø–æ–∫–∞–∑—É –Ω–∞–π–±–ª–∏–∂—á–∏—Ö –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
"""

import sys
import os
from datetime import date, timedelta

# –î–æ–¥–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –¥–æ Python path
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

from cli.interface import PersonalAssistantCLI
from models.contact import Contact

def demo_birthdays():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ–º–∞–Ω–¥–∏ birthdays"""
    
    print("üéÇ –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–Ø –§–£–ù–ö–¶–Ü–û–ù–ê–õ–¨–ù–û–°–¢–Ü –ù–ê–ô–ë–õ–ò–ñ–ß–ò–• –î–ù–Ü–í –ù–ê–†–û–î–ñ–ï–ù–ù–Ø\n")
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ CLI
    cli = PersonalAssistantCLI()
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ—Å—Ç–æ–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–Ω—è–º–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    contacts_data = [
        ("–Ü–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤", 0, "+380501234567"),  # –°—å–æ–≥–æ–¥–Ω—ñ
        ("–ú–∞—Ä—ñ—è –Ü–≤–∞–Ω–æ–≤–∞", 1, "+380501234568"),  # –ó–∞–≤—Ç—Ä–∞  
        ("–ü–µ—Ç—Ä–æ –°–∏–¥–æ—Ä–µ–Ω–∫–æ", 3, "+380501234569"),  # –ß–µ—Ä–µ–∑ 3 –¥–Ω—ñ
        ("–û–ª—å–≥–∞ –ö–æ–≤–∞–ª–µ–Ω–∫–æ", 7, "+380501234570"),  # –ß–µ—Ä–µ–∑ 7 –¥–Ω—ñ–≤
        ("–ê–Ω–¥—Ä—ñ–π –®–µ–≤—á–µ–Ω–∫–æ", 15, "+380501234571"), # –ß–µ—Ä–µ–∑ 15 –¥–Ω—ñ–≤ (–Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏—Å—è –ø—Ä–∏ –ø–æ—à—É–∫—É –Ω–∞ 7 –¥–Ω—ñ–≤)
    ]
    
    print("–°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ—Å—Ç–æ–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏:")
    
    for name, days_offset, phone in contacts_data:
        contact = Contact(name)
        contact.add_phone(phone)
        
        # –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        birthday_date = date.today() + timedelta(days=days_offset)
        # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ä—ñ–∫ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –≤ –º–∏–Ω—É–ª–µ
        birthday_year = birthday_date.year - 25  
        birthday_str = f"{birthday_date.day:02d}.{birthday_date.month:02d}.{birthday_year}"
        
        contact.set_birthday(birthday_str)
        cli.contact_manager._contacts.append(contact)
        
        if days_offset == 0:
            status = "–°–¨–û–ì–û–î–ù–Ü üéâ"
        elif days_offset == 1:
            status = "–∑–∞–≤—Ç—Ä–∞ üéÇ"
        else:
            status = f"—á–µ—Ä–µ–∑ {days_offset} –¥–Ω—ñ–≤"
            
        print(f"  ‚Ä¢ {name} - –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è {status}")
    
    print(f"\n–í—Å—å–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤: {len(contacts_data)}")
    
    # –¢–µ—Å—Ç—É—î–º–æ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –∫–æ–º–∞–Ω–¥–∏
    test_cases = [
        ("birthdays", "–ö–æ–º–∞–Ω–¥–∞ 'birthdays' (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 7 –¥–Ω—ñ–≤)"),
        ("–¥–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è", "–ö–æ–º–∞–Ω–¥–∞ '–¥–Ω—ñ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è' (—É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é)"),
    ]
    
    for command, description in test_cases:
        print(f"\n{'='*60}")
        print(f"üß™ –¢–ï–°–¢: {description}")
        print('='*60)
        
        print(f"–í–∏–∫–æ–Ω—É—î–º–æ –∫–æ–º–∞–Ω–¥—É: '{command}'")
        print("\n" + "‚îÄ"*50)
        
        # –°–∏–º—É–ª—é—î–º–æ –≤–≤–µ–¥–µ–Ω–Ω—è "7" –¥–ª—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –¥–Ω—ñ–≤
        import unittest.mock as mock
        with mock.patch('builtins.input', return_value='7'):
            result = cli.process_command(command)
            print(result)
        
        print("‚îÄ"*50)
    
    # –¢–µ—Å—Ç—É—î–º–æ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø–µ—Ä—ñ–æ–¥–∞–º–∏
    print(f"\n{'='*60}")
    print("üß™ –¢–ï–°–¢: –†—ñ–∑–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ –ø–æ—à—É–∫—É")
    print('='*60)
    
    periods = [1, 3, 7, 30]
    
    for days in periods:
        print(f"\nüìÖ –ü–æ—à—É–∫ –Ω–∞ {days} –¥–Ω—ñ–≤ –Ω–∞–ø–µ—Ä–µ–¥:")
        print("-" * 40)
        
        upcoming = cli.contact_manager.get_upcoming_birthdays(days)
        if upcoming:
            for contact in upcoming:
                days_to_bd = contact.days_to_birthday()
                if days_to_bd == 0:
                    status = "–°–¨–û–ì–û–î–ù–Ü!"
                elif days_to_bd == 1:
                    status = "–∑–∞–≤—Ç—Ä–∞"
                else:
                    status = f"—á–µ—Ä–µ–∑ {days_to_bd} –¥–Ω—ñ–≤"
                    
                print(f"  üéÇ {contact.name.value} - {status}")
        else:
            print(f"  ‚ÑπÔ∏è –ù–∞ {days} –¥–Ω—ñ–≤ –≤–ø–µ—Ä–µ–¥ –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –Ω–µ–º–∞—î")
    
    print(f"\n{'='*60}")
    print("‚úÖ –î–ï–ú–û–ù–°–¢–†–ê–¶–Ü–Ø –ó–ê–í–ï–†–®–ï–ù–ê")
    print(f"{'='*60}")
    
    print("\nüìã –ü–Ü–î–°–£–ú–û–ö –§–£–ù–ö–¶–Ü–û–ù–ê–õ–¨–ù–û–°–¢–Ü:")
    print("  ‚úÖ –ü–æ—à—É–∫ –∫–æ–Ω—Ç–∞–∫—Ç—ñ–≤ –∑ –¥–Ω—è–º–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤")
    print("  ‚úÖ –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∑–∞ –¥–∞—Ç–∞–º–∏ (–Ω–∞–π–±–ª–∏–∂—á—ñ —Å–ø–æ—á–∞—Ç–∫—É)")
    print("  ‚úÖ –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é —Ç–∞ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é")
    print("  ‚úÖ –ì–Ω—É—á–∫–∏–π –ø–µ—Ä—ñ–æ–¥ –ø–æ—à—É–∫—É (–≤—ñ–¥ 1 –¥–Ω—è –¥–æ –Ω–µ–æ–±–º–µ–∂–µ–Ω–æ–≥–æ)")
    print("  ‚úÖ –ö—Ä–∞—Å–∏–≤–∏–π –≤–∏–≤—ñ–¥ –∑ –µ–º–æ–¥–∑—ñ —Ç–∞ —Å—Ç–∞—Ç—É—Å–∞–º–∏")
    print("  ‚úÖ –ü–æ–∫–∞–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—Ç–µ–ª–µ—Ñ–æ–Ω–∏)")
    
    print("\nüéØ –í–ò–°–ù–û–í–û–ö: –í–∏–º–æ–≥–∞ –ü–û–í–ù–Ü–°–¢–Æ –†–ï–ê–õ–Ü–ó–û–í–ê–ù–ê!")

if __name__ == "__main__":
    demo_birthdays()