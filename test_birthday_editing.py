#!/usr/bin/env python3
"""
–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–∞ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ CLI

–¶–µ–π —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç—É—î –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:
1. –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –∫–æ–Ω—Ç–∞–∫—Ç—É
2. –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É  
3. –í–∏–¥–∞–ª–µ–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
"""

from cli.interface import PersonalAssistantCLI
import unittest.mock as mock

def test_birthday_editing():
    """–¢–µ—Å—Ç—É—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è"""
    
    print("üéÇ –¢–ï–°–¢ –§–£–ù–ö–¶–Ü–û–ù–ê–õ–¨–ù–û–°–¢–Ü –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –î–ù–Ü–í –ù–ê–†–û–î–ñ–ï–ù–ù–Ø")
    print("=" * 60)
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ CLI
    cli = PersonalAssistantCLI()
    
    # –û—á–∏—â—É—î–º–æ —ñ—Å–Ω—É—é—á—ñ –¥–∞–Ω—ñ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Ç–µ—Å—Ç—É
    cli.contact_manager._contacts.clear()
    
    print("\n1Ô∏è‚É£ –¢–ï–°–¢ –î–û–î–ê–í–ê–ù–ù–Ø –ö–û–ù–¢–ê–ö–¢–£ –ó –î–ù–ï–ú –ù–ê–†–û–î–ñ–ï–ù–ù–Ø")
    print("-" * 50)
    print("–°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è...")
    
    # –°–∏–º—É–ª—é—î–º–æ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    inputs_new_contact = [
        "–¢–µ—Å—Ç–æ–≤–∏–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á",  # —ñ–º'—è
        "+380501234567",        # —Ç–µ–ª–µ—Ñ–æ–Ω
        "test@example.com",     # email
        "15.05.1990",          # –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "–≤—É–ª. –¢–µ—Å—Ç–æ–≤–∞, 1"      # –∞–¥—Ä–µ—Å–∞
    ]
    
    with mock.patch('builtins.input', side_effect=inputs_new_contact):
        result = cli.process_command('add contact')
        print(result)
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –¥–æ–¥–∞–≤—Å—è –∫–æ–Ω—Ç–∞–∫—Ç
    contact = cli.contact_manager.find_contact("–¢–µ—Å—Ç–æ–≤–∏–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á")
    if contact and contact.birthday:
        print(f"‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–æ –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: {contact.birthday.value}")
    else:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–∞–∫—Ç—É")
    
    print("\n2Ô∏è‚É£ –¢–ï–°–¢ –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –î–ù–Ø –ù–ê–†–û–î–ñ–ï–ù–ù–Ø")
    print("-" * 50)
    print("–†–µ–¥–∞–≥—É—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç—É...")
    
    # –°–∏–º—É–ª—é—î–º–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    inputs_edit = [
        "–¢–µ—Å—Ç–æ–≤–∏–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á",  # —ñ–º'—è –∫–æ–Ω—Ç–∞–∫—Ç—É
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ email
        "y",                    # —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "20.12.1985",          # –Ω–æ–≤–∏–π –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "n"                     # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å—É
    ]
    
    with mock.patch('builtins.input', side_effect=inputs_edit):
        result = cli.process_command('edit contact')
        print(result)
    
    # –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∑–º—ñ–Ω–∏
    contact = cli.contact_manager.find_contact("–¢–µ—Å—Ç–æ–≤–∏–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á")
    if contact and contact.birthday and contact.birthday.value == "20.12.1985":
        print(f"‚úÖ –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω–æ: {contact.birthday.value}")
    else:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è")
    
    print("\n3Ô∏è‚É£ –¢–ï–°–¢ –î–û–î–ê–í–ê–ù–ù–Ø –î–ù–Ø –ù–ê–†–û–î–ñ–ï–ù–ù–Ø –î–û –Ü–°–ù–£–Æ–ß–û–ì–û –ö–û–ù–¢–ê–ö–¢–£")
    print("-" * 50)
    
    # –°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–Ω—Ç–∞–∫—Ç –±–µ–∑ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    inputs_no_birthday = [
        "–ö–æ–Ω—Ç–∞–∫—Ç –ë–µ–∑ –î–ù",      # —ñ–º'—è
        "+380509876543",        # —Ç–µ–ª–µ—Ñ–æ–Ω
        "nobday@test.com",      # email
        "",                     # –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        ""                      # –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –∞–¥—Ä–µ—Å—É
    ]
    
    print("–°—Ç–≤–æ—Ä—é—î–º–æ –∫–æ–Ω—Ç–∞–∫—Ç –±–µ–∑ –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è...")
    with mock.patch('builtins.input', side_effect=inputs_no_birthday):
        result = cli.process_command('add contact')
        print(result)
    
    # –¢–µ–ø–µ—Ä –¥–æ–¥–∞—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
    inputs_add_birthday = [
        "–ö–æ–Ω—Ç–∞–∫—Ç –ë–µ–∑ –î–ù",      # —ñ–º'—è –∫–æ–Ω—Ç–∞–∫—Ç—É
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ email
        "y",                    # —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "01.01.2000",          # –¥–æ–¥–∞—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "n"                     # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å—É
    ]
    
    print("–î–æ–¥–∞—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è...")
    with mock.patch('builtins.input', side_effect=inputs_add_birthday):
        result = cli.process_command('edit contact')
        print(result)
    
    contact = cli.contact_manager.find_contact("–ö–æ–Ω—Ç–∞–∫—Ç –ë–µ–∑ –î–ù")
    if contact and contact.birthday:
        print(f"‚úÖ –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –¥–æ–¥–∞–Ω–æ: {contact.birthday.value}")
    else:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è")
    
    print("\n4Ô∏è‚É£ –¢–ï–°–¢ –í–ò–î–ê–õ–ï–ù–ù–Ø –î–ù–Ø –ù–ê–†–û–î–ñ–ï–ù–ù–Ø")
    print("-" * 50)
    
    # –í–∏–¥–∞–ª—è—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
    inputs_remove_birthday = [
        "–ö–æ–Ω—Ç–∞–∫—Ç –ë–µ–∑ –î–ù",      # —ñ–º'—è –∫–æ–Ω—Ç–∞–∫—Ç—É
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω
        "n",                    # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ email
        "y",                    # —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
        "",                     # –≤–∏–¥–∞–ª—è—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è (–ø–æ—Ä–æ–∂–Ω—ñ–π –≤–≤—ñ–¥)
        "n"                     # –Ω–µ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–¥—Ä–µ—Å—É
    ]
    
    print("–í–∏–¥–∞–ª—è—î–º–æ –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è...")
    with mock.patch('builtins.input', side_effect=inputs_remove_birthday):
        result = cli.process_command('edit contact')
        print(result)
    
    contact = cli.contact_manager.find_contact("–ö–æ–Ω—Ç–∞–∫—Ç –ë–µ–∑ –î–ù")
    if contact and not contact.birthday:
        print("‚úÖ –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –≤–∏–¥–∞–ª–µ–Ω–æ")
    else:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–Ω—è –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è")
    
    print("\n5Ô∏è‚É£ –¢–ï–°–¢ –ö–û–ú–ê–ù–î–ò BIRTHDAYS")
    print("-" * 50)
    
    print("–ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–º–∞–Ω–¥—É birthdays –∑ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏...")
    with mock.patch('builtins.input', return_value='365'):
        result = cli.process_command('birthdays')
        print(result)
    
    print("\n" + "=" * 60)
    print("‚úÖ –í–°–Ü –¢–ï–°–¢–ò –ó–ê–í–ï–†–®–ï–ù–û!")
    print("üéØ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¥–Ω—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–∞—Ü—é—î")
    print("=" * 60)

if __name__ == "__main__":
    test_birthday_editing()